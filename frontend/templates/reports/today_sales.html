{% extends "base.html" %}
{% block title %}Today's Sales{% endblock %}
{% block page_title %}Reports{% endblock %}

{% block content %}

<div class="pg-head">
    <div>
        <h1>Today's Sales</h1>
        <p>Sales recorded on {{ today|date:"M d, Y" }}.</p>
    </div>
    <a href="/reports/" class="btn btn-outline-secondary btn-sm">Back to Reports</a>
</div>

<div class="stat-grid mb-3" style="grid-template-columns:repeat(2,1fr);">
    <div class="stat-card">
        <div class="stat-icon" style="background:rgba(16,185,129,.1);">
            <svg width="18" height="18" fill="none" stroke="#10b981" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        </div>
        <div>
            <div class="stat-label">Total Revenue</div>
            <div class="stat-value" style="font-size:1.2rem;">Rs.{{ total_sales|floatformat:0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon" style="background:rgba(99,102,241,.1);">
            <svg width="18" height="18" fill="none" stroke="#6366f1" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
        </div>
        <div>
            <div class="stat-label">Transactions</div>
            <div class="stat-value">{{ sales|length }}</div>
        </div>
    </div>
</div>

{% if sales %}
<div class="table-responsive">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Sale #</th>
                <th>Time</th>
                <th>Customer</th>
                <th>Total</th>
                <th>Method</th>
                <th>Status</th>
                <th>Order</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for sale in sales %}
            <tr>
                <td style="font-family:monospace;font-size:.78rem;color:var(--brand-dark);font-weight:600;">{{ sale.sale_number }}</td>
                <td style="font-size:.75rem;color:var(--text-muted);">{{ sale.sale_date|date:"H:i" }}</td>
                <td style="font-size:.8rem;">
                    {% if sale.irregular_customer %}
                        <span style="color:var(--text-muted);font-size:.7rem;">Walk-in:</span> {{ sale.irregular_customer.customer_name }}
                    {% else %}
                        {{ sale.customer.customer_name|default:"Walk-in" }}
                    {% endif %}
                </td>
                <td style="font-weight:600;">Rs.{{ sale.total_amount }}</td>
                <td style="font-size:.78rem;">{{ sale.get_payment_method_display }}</td>
                <td>
                    {% if sale.payment_status == 'paid' %}
                        <span class="badge" style="background:#dcfce7;color:#166534;">Paid</span>
                    {% elif sale.payment_status == 'pending' %}
                        <span class="badge" style="background:#fef9c3;color:#a16207;">Pending</span>
                    {% else %}
                        <span class="badge" style="background:#ffedd5;color:#c2410c;">{{ sale.payment_status|capfirst }}</span>
                    {% endif %}
                </td>
                <td>
                    {% if sale.order_status == 'completed' %}
                        <span class="badge" style="background:#dcfce7;color:#166534;">Completed</span>
                    {% elif sale.order_status == 'cancelled' %}
                        <span class="badge" style="background:#fee2e2;color:#991b1b;">Cancelled</span>
                    {% else %}
                        <span class="badge" style="background:#f1f5f9;color:#64748b;">{{ sale.order_status|capfirst }}</span>
                    {% endif %}
                </td>
                <td>
                    <div style="display:flex;gap:4px;">
                        <a href="/sales/{{ sale.sale_number }}/" class="btn btn-xs btn-outline-secondary">View</a>
                        <a href="/sales/receipt/{{ sale.sale_number }}/" class="btn btn-xs btn-outline-success">Receipt</a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card">
    <div class="card-b text-center" style="padding:40px;color:var(--text-muted);">
        No sales recorded today.
    </div>
</div>
{% endif %}

{% endblock %}
