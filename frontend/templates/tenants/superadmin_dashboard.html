{% extends 'base.html' %}
{% block title %}Superadmin Dashboard{% endblock %}
{% block page_title %}Superadmin{% endblock %}

{% block content %}

<div class="pg-head">
    <div>
        <h1>Vendors</h1>
        <p>Manage all vendor accounts and access.</p>
    </div>
    <div style="display:flex;gap:8px;align-items:center;">
        <a href="{% url 'superadmin_change_password' %}" class="btn btn-outline-secondary btn-sm">Change Password</a>
        <a href="{% url 'create_vendor' %}" class="btn btn-primary btn-sm">+ New Vendor</a>
    </div>
</div>

<div class="stat-grid mb-3" style="grid-template-columns:repeat(3,1fr);">
    <div class="stat-card">
        <div class="stat-icon" style="background:rgba(99,102,241,.1);">
            <svg width="18" height="18" fill="none" stroke="#6366f1" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>
        </div>
        <div><div class="stat-label">Total Vendors</div><div class="stat-value">{{ total_vendors }}</div></div>
    </div>
    <div class="stat-card">
        <div class="stat-icon" style="background:rgba(16,185,129,.1);">
            <svg width="18" height="18" fill="none" stroke="#10b981" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        </div>
        <div><div class="stat-label">Active</div><div class="stat-value">{{ active_vendors }}</div></div>
    </div>
    <div class="stat-card">
        <div class="stat-icon" style="background:rgba(239,68,68,.1);">
            <svg width="18" height="18" fill="none" stroke="#ef4444" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        </div>
        <div><div class="stat-label">Inactive</div><div class="stat-value">{{ inactive_vendors }}</div></div>
    </div>
</div>

<div class="card">
    <div class="card-h">All Vendors</div>
    {% if vendors %}
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Vendor</th>
                    <th>Code</th>
                    <th>Admin Email</th>
                    <th>Status</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for vendor in vendors %}
                <tr>
                    <td class="fw-semibold">{{ vendor.name }}</td>
                    <td><code style="background:#f1f5f9;padding:2px 6px;border-radius:4px;font-size:.75rem;">{{ vendor.code }}</code></td>
                    <td style="font-size:.78rem;">{{ vendor.owner_email }}</td>
                    <td>
                        {% if vendor.is_active %}
                            <span class="badge" style="background:#dcfce7;color:#166534;">{{ vendor.status|title }}</span>
                        {% else %}
                            <span class="badge" style="background:#f1f5f9;color:#64748b;">Inactive</span>
                        {% endif %}
                    </td>
                    <td style="color:var(--text-muted);font-size:.75rem;">{{ vendor.created_at|date:"Y-m-d" }}</td>
                    <td>
                        <div style="display:flex;gap:4px;flex-wrap:wrap;">
                            <a href="{% url 'vendor_detail' vendor.id %}" class="btn btn-xs btn-outline-secondary">View</a>
                            <a href="{% url 'superadmin_login_as_vendor' vendor.id %}" class="btn btn-xs btn-outline-primary">Login as</a>
                            {% if vendor.is_active %}
                            <a href="{% url 'deactivate_vendor' vendor.id %}" class="btn btn-xs btn-outline-danger">Deactivate</a>
                            {% else %}
                            <a href="{% url 'activate_vendor' vendor.id %}" class="btn btn-xs btn-outline-success">Activate</a>
                            {% endif %}
                            <a href="{% url 'delete_vendor' vendor.id %}" class="btn btn-xs btn-danger">Delete</a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="card-b text-center" style="color:var(--text-muted);padding:32px;">
        No vendors yet. <a href="{% url 'create_vendor' %}">Create one now</a>
    </div>
    {% endif %}
</div>

{% endblock %}
